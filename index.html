<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Leaderboard</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font/dist/font-face.css" rel="stylesheet" type="text/css" />
    <style>
        body {
            font-family: 'Vazir', Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            text-align: center;
        }
        .color-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            margin-right: 10px;
        }
        .leaderboard-entry {
            display: flex;
            align-items: center;
            margin: 10px auto;
            padding: 10px;
            width: 50%;
            border: 2px solid #d83939;
            border-radius: 50px;
            box-sizing: border-box;
        }
        .leaderboard-entry .name {
            font-weight: bold;
            margin-right: auto;
        }
        .leaderboard-entry .score {
            font-size: 1.5em;
            font-weight: bold;
            color: #d83939;
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <h1>لیــــدربـــــرد مغـــــازه</h1>
    <div id="leaderboard"></div>

    <script>
        const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRM_bD3CHrtSDMOt2-iJ04wbivtj99QdolG2ehTI1ZD8kkYyMA5rL4b-LFyTy6KSXQiJWeP_1sW9SUK/pub?output=csv";

        function parseCSV(csv) {
            const lines = csv.trim().split("\n");
            return lines.slice(1).map(line => {
                const [Photo, Name, Score] = line.split(",");
                return { Name, Score: parseInt(Score, 10) };
            });
        }

        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        function randomCharacter() {
            const chars = ['❂', '✼', '❖', '❉', '⌘']; // You can add more characters
            return chars[Math.floor(Math.random() * chars.length)];
        }

        function convertToPersianNumber(number) {
            const persianDigits = '۰۱۲۳۴۵۶۷۸۹';
            return number.toString().replace(/\d/g, (digit) => persianDigits[digit]);
        }

        fetch(sheetURL)
            .then(response => response.text())
            .then(csvText => {
                const data = parseCSV(csvText);
                data.sort((a, b) => b.Score - a.Score);

                const leaderboard = document.getElementById("leaderboard");
                data.forEach(entry => {
                    const row = document.createElement("div");
                    row.className = "leaderboard-entry";

                    const circle = document.createElement("div");
                    circle.className = "color-circle";
                    circle.textContent = randomCharacter();
                    circle.style.backgroundColor = getRandomColor();

                    const nameSpan = document.createElement("div");
                    nameSpan.className = "name";
                    nameSpan.textContent = entry.Name;

                    const scoreSpan = document.createElement("div");
                    scoreSpan.className = "score";
                    scoreSpan.textContent = convertToPersianNumber(entry.Score);

                    row.appendChild(circle);
                    row.appendChild(nameSpan);
                    row.appendChild(scoreSpan);
                    leaderboard.appendChild(row);
                });
            })
            .catch(error => {
                console.error("Error fetching or parsing CSV:", error);
            });
    </script>
</body>
</html>
